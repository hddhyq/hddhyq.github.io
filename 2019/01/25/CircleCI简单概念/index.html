<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.0"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="baidu-site-verification" content="hoM8zKNZAC"><meta><title>CircleCI简单概念 - hddhyq&#039;s blog</title><meta description="又是关于前两个星期零零星星看的文章的总结，主要关于 CircleCI 。首先是CircleCI的介绍，然后下一篇文字介绍下部署一个vue项目到gh-pages的步骤。"><meta property="og:type" content="article"><meta property="og:title" content="CircleCI简单概念"><meta property="og:url" content="https://hddhyq.github.io/2019/01/25/CircleCI%E7%AE%80%E5%8D%95%E6%A6%82%E5%BF%B5/"><meta property="og:site_name" content="hddhyq&#039;s blog"><meta property="og:description" content="又是关于前两个星期零零星星看的文章的总结，主要关于 CircleCI 。首先是CircleCI的介绍，然后下一篇文字介绍下部署一个vue项目到gh-pages的步骤。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://en.gravatar.com/userimage/154887614/195fa361a4d6896c0a6115026aefb041.png?size=300"><meta property="article:published_time" content="2019-01-25T13:05:10.000Z"><meta property="article:modified_time" content="2020-03-27T08:06:33.234Z"><meta property="article:author" content="hddhyq"><meta property="article:tag" content="自动化"><meta property="article:tag" content="CircleCI"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://en.gravatar.com/userimage/154887614/195fa361a4d6896c0a6115026aefb041.png?size=300"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://hddhyq.github.io/2019/01/25/CircleCI%E7%AE%80%E5%8D%95%E6%A6%82%E5%BF%B5/"},"headline":"CircleCI简单概念","image":[],"datePublished":"2019-01-25T13:05:10.000Z","dateModified":"2020-03-27T08:06:33.234Z","author":{"@type":"Person","name":"hddhyq"},"description":"又是关于前两个星期零零星星看的文章的总结，主要关于 CircleCI 。首先是CircleCI的介绍，然后下一篇文字介绍下部署一个vue项目到gh-pages的步骤。"}</script><link rel="alternative" href="/atom.xml" title="hddhyq&#039;s blog" type="application/atom+xml"><link rel="icon" href="/img/favicon.ico"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro|Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Microsoft YaHei:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&amp;amp;subset=latin,latin-ext|Inconsolata|Itim|Lobster.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-dark.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.12/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><link rel="stylesheet" href="/css/style.css"><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="/js/globalUtils.js"></script></head><body class="is-3-column has-navbar-fixed-top"><nav class="navbar navbar-main is-fixed-top"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="https://images-1253206717.cos.ap-guangzhou.myqcloud.com/blog/logo.png" alt="hddhyq&#039;s blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/message">留言</a><a class="navbar-item" href="/about">关于</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/hddhyq"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><script type="text/javascript" src="/js/theme-setting.js"></script><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-01-25T13:05:10.000Z">2019-01-25</time><a class="commentCountImg" href="/2019/01/25/CircleCI%E7%AE%80%E5%8D%95%E6%A6%82%E5%BF%B5/#comment-container"><span class="display-none-class">a7947a82ad6a05c780350781cb0fdddb</span><img class="not-gallery-item" src="/img/chat.svg"> <span class="commentCount" id="a7947a82ad6a05c780350781cb0fdddb"> 99+</span>    </a><span class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="link-muted" href="/categories/CircleCI/">CircleCI</a></span><span class="level-item">26 分钟 读完 (大约 3908 个字)</span><span class="level-item" id="busuanzi_container_page_pv"><i class="far fa-eye"></i>&nbsp;&nbsp;<span id="busuanzi_value_page_pv">0</span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">CircleCI简单概念</h1><div class="content"><p>又是关于前两个星期零零星星看的文章的总结，主要关于 CircleCI 。首先是CircleCI的介绍，然后下一篇文字介绍下部署一个vue项目到gh-pages的步骤。 <a id="more"></a></p>
<h1 id="概念">概念</h1>
<p><a href="https://circleci.com/docs/2.0/hello-world/">导航</a>,<a href="https://circleci.com/docs/2.0/concepts/">概念</a> ## 步骤（Steps）</p>
<p>步骤一般是可执行的命令组成的。</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#...</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">checkout</span> <span class="comment"># Special step to checkout your source code</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">run:</span> <span class="comment"># Run step to execute commands, see</span></span><br><span class="line">      <span class="comment"># circleci.com/docs/2.0/configuration-reference/#run</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">Running</span> <span class="string">tests</span></span><br><span class="line">          <span class="attr">command:</span> <span class="string">make</span> <span class="string">test</span> <span class="comment"># executable command run in</span></span><br><span class="line">          <span class="comment"># non-login shell with /bin/bash -eo pipefail option</span></span><br><span class="line">          <span class="comment"># by default.</span></span><br><span class="line"><span class="comment">#...</span></span><br></pre></td></tr></table></figure>
<h2 id="镜像image">镜像（Image）</h2>
<p>指定确定的docker容器。</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">version</span> <span class="number">2</span></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">build1:</span> <span class="comment"># job name</span></span><br><span class="line">    <span class="attr">docker:</span> <span class="comment"># Specifies the primary container image,</span></span><br><span class="line">    <span class="comment"># see circleci.com/docs/2.0/circleci-images/ for</span></span><br><span class="line">    <span class="comment"># the list of pre-built CircleCI images on dockerhub.</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">buildpack-deps:trusty</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">postgres:9.4.1</span> <span class="comment"># Specifies the database image</span></span><br><span class="line">      <span class="comment"># for the secondary or service container run in a common</span></span><br><span class="line">      <span class="comment"># network where ports exposed on the primary container are</span></span><br><span class="line">      <span class="comment"># available on localhost.</span></span><br><span class="line">        <span class="attr">environment:</span> <span class="comment"># Specifies the POSTGRES_USER authentication</span></span><br><span class="line">        <span class="comment"># environment variable, see circleci.com/docs/2.0/env-vars/</span></span><br><span class="line">        <span class="comment"># for instructions about using environment variables.</span></span><br><span class="line">          <span class="attr">POSTGRES_USER:</span> <span class="string">root</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line">  <span class="attr">build2:</span></span><br><span class="line">    <span class="attr">machine:</span> <span class="comment"># Specifies a machine image that uses</span></span><br><span class="line">    <span class="comment"># an Ubuntu version 14.04 image with Docker 17.06.1-ce</span></span><br><span class="line">    <span class="comment"># and docker-compose 1.14.0, follow CircleCI Discuss Announcements</span></span><br><span class="line">    <span class="comment"># for new image releases.</span></span><br><span class="line">      <span class="attr">image:</span> <span class="string">circleci/classic:201708-01</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line">  <span class="attr">build3:</span></span><br><span class="line">    <span class="attr">macos:</span> <span class="comment"># Specifies a macOS virtual machine with Xcode version 9.0</span></span><br><span class="line">      <span class="attr">xcode:</span> <span class="string">"9.0"</span></span><br><span class="line"><span class="string">...</span></span><br></pre></td></tr></table></figure>
<h2 id="任务jobs">任务（Jobs）</h2>
<p>任务是步骤的集合，单个任务必须指定<code>docker</code>，<code>machine</code>和<code>macos</code>。</p>
<h3 id="缓存">缓存</h3>
<p>可以缓存诸如项目中源代码的依赖的文件或者目录。</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="number">2</span></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">build1:</span></span><br><span class="line">    <span class="attr">docker:</span> <span class="comment"># Each job requires specifying an executor</span></span><br><span class="line">    <span class="comment"># (either docker, macos, or machine), see</span></span><br><span class="line">    <span class="comment"># circleci.com/docs/2.0/executor-types/ for a comparison</span></span><br><span class="line">    <span class="comment"># and more examples.</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">circleci/ruby:2.4-node</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">circleci/postgres:9.4.12-alpine</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">checkout</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">save_cache:</span> <span class="comment"># Caches dependencies with a cache key</span></span><br><span class="line">      <span class="comment"># template for an environment variable,</span></span><br><span class="line">      <span class="comment"># see circleci.com/docs/2.0/caching/</span></span><br><span class="line">          <span class="attr">key:</span> <span class="string">v1-repo-&#123;&#123;</span> <span class="string">.Environment.CIRCLE_SHA1</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">paths:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">~/circleci-demo-workflows</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">build2:</span></span><br><span class="line">    <span class="attr">docker:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">circleci/ruby:2.4-node</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">circleci/postgres:9.4.12-alpine</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">restore_cache:</span> <span class="comment"># Restores the cached dependency.</span></span><br><span class="line">          <span class="attr">key:</span> <span class="string">v1-repo-&#123;&#123;</span> <span class="string">.Environment.CIRCLE_SHA1</span> <span class="string">&#125;&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="工作流">工作流</h2>
<p>工作流定义了一系列的任务和他们的运行顺序。它可以使任务并行，穿行和按计划或者手动控制运行。</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="number">2</span></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">build1:</span></span><br><span class="line">    <span class="attr">docker:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">circleci/ruby:2.4-node</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">circleci/postgres:9.4.12-alpine</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">checkout</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">save_cache:</span> <span class="comment"># Caches dependencies with a cache key</span></span><br><span class="line">          <span class="attr">key:</span> <span class="string">v1-repo-&#123;&#123;</span> <span class="string">.Environment.CIRCLE_SHA1</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">paths:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">~/circleci-demo-workflows</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">build2:</span></span><br><span class="line">    <span class="attr">docker:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">circleci/ruby:2.4-node</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">circleci/postgres:9.4.12-alpine</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">restore_cache:</span> <span class="comment"># Restores the cached dependency.</span></span><br><span class="line">          <span class="attr">key:</span> <span class="string">v1-repo-&#123;&#123;</span> <span class="string">.Environment.CIRCLE_SHA1</span> <span class="string">&#125;&#125;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">run:</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">Running</span> <span class="string">tests</span></span><br><span class="line">          <span class="attr">command:</span> <span class="string">make</span> <span class="string">test</span></span><br><span class="line">  <span class="attr">build3:</span></span><br><span class="line">    <span class="attr">docker:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">circleci/ruby:2.4-node</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">circleci/postgres:9.4.12-alpine</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">restore_cache:</span> <span class="comment"># Restores the cached dependency.</span></span><br><span class="line">          <span class="attr">key:</span> <span class="string">v1-repo-&#123;&#123;</span> <span class="string">.Environment.CIRCLE_SHA1</span> <span class="string">&#125;&#125;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">run:</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">Precompile</span> <span class="string">assets</span></span><br><span class="line">          <span class="attr">command:</span> <span class="string">bundle</span> <span class="string">exec</span> <span class="string">rake</span> <span class="string">assets:precompile</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line"><span class="attr">workflows:</span></span><br><span class="line">  <span class="attr">version:</span> <span class="number">2</span></span><br><span class="line">  <span class="attr">build_and_test:</span> <span class="comment"># name of your workflow</span></span><br><span class="line">    <span class="attr">jobs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">build1</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">build2:</span></span><br><span class="line">        <span class="attr">requires:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="string">build1</span> <span class="comment"># wait for build1 job to complete successfully before starting</span></span><br><span class="line">          <span class="comment"># see circleci.com/docs/2.0/workflows/ for more examples.</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">build3:</span></span><br><span class="line">        <span class="attr">requires:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="string">build1</span> <span class="comment"># wait for build1 job to complete successfully before starting</span></span><br><span class="line">          <span class="comment"># run build2 and build3 in parallel to save time.</span></span><br></pre></td></tr></table></figure>
<h3 id="工作区域和文件">工作区域和文件</h3>
<p>Artifacts， Workspaces，Caches的讨论看 <a href="https://circleci.com/blog/persisting-data-in-workflows-when-to-use-caching-artifacts-and-workspaces/">Persisting Data in Workflows: When to Use Caching, Artifacts, and Workspaces</a></p>
<p>也可以看看 <a href="https://circleci.com/docs/2.0/jobs-steps/">Jobs and Steps</a>来查看更多。</p>
<h1 id="工作流-1"><a href="https://circleci.com/docs/2.0/workflows">工作流</a></h1>
<p><img src="https://images-1253206717.cos.ap-guangzhou.myqcloud.com/blog/circleci/wf-header.png" /></p>
<p>要通过更快的反馈，更短的重运行时间和更有效的资源使用来提高软件开发的速度，请配置工作流程。这个文档描述了工作流程的特性而且提供以下章节的用例：</p>
<ul>
<li>概述</li>
<li>工作流配置案例</li>
<li>手动控制持久工作流</li>
<li>有序化一个工作流程</li>
<li>使用上下文来过滤你的工作流程</li>
<li>使用工作区来在任务重分享数据</li>
<li>重运行失败的任务</li>
<li>故障排除</li>
</ul>
<h2 id="概述">概述</h2>
<p>你能做的有：</p>
<ul>
<li>通过实时状态反馈来运行和解决任务中的问题</li>
<li>将需要定期执行的工作流按计划执行</li>
<li>通过多个并行任务来进行有效的版本测试</li>
<li>快速部署到多个不同的平台</li>
</ul>
<h3 id="平行任务">平行任务</h3>
<p>在底部添加<code>workflows</code>，通过build_and_test 可看<a href="https://github.com/CircleCI-Public/circleci-demo-workflows/blob/parallel-jobs/.circleci/config.yml">Sample Parallel Workflow config</a></p>
<h3 id="顺序任务">顺序任务</h3>
<p>需要添加<code>require</code>关键字。 <figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">workflows:</span></span><br><span class="line">  <span class="attr">version:</span> <span class="number">2</span></span><br><span class="line">  <span class="attr">build-test-and-deploy:</span></span><br><span class="line">    <span class="attr">jobs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">build</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">test1:</span></span><br><span class="line">          <span class="attr">requires:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">build</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">test2:</span></span><br><span class="line">          <span class="attr">requires:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">test1</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">deploy:</span></span><br><span class="line">          <span class="attr">requires:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">test2</span></span><br></pre></td></tr></table></figure></p>
<h3 id="扇出扇入工作流示例">扇出/扇入工作流示例</h3>
<p>下面视图扇出一组工作流，然后扇入来运行公共的部署任务： <a href="https://github.com/CircleCI-Public/circleci-demo-workflows/tree/fan-in-fan-out">Sample Fan-in/Fan-out Workflow config</a></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">workflows:</span></span><br><span class="line">  <span class="attr">version:</span> <span class="number">2</span></span><br><span class="line">  <span class="attr">build_accept_deploy:</span></span><br><span class="line">    <span class="attr">jobs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">build</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">acceptance_test_1:</span></span><br><span class="line">          <span class="attr">requires:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">build</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">acceptance_test_2:</span></span><br><span class="line">          <span class="attr">requires:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">build</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">acceptance_test_3:</span></span><br><span class="line">          <span class="attr">requires:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">build</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">acceptance_test_4:</span></span><br><span class="line">          <span class="attr">requires:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">build</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">deploy:</span></span><br><span class="line">          <span class="attr">requires:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">acceptance_test_1</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">acceptance_test_2</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">acceptance_test_3</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">acceptance_test_4</span></span><br></pre></td></tr></table></figure>
<h3 id="通过手动批准来控制工作流">通过手动批准来控制工作流</h3>
<p>工作流可以设置为需要手动批准再进行下一个任务。任何有权利访问代码库的人都可以继续工作流。为了做到这一点，在任务列表中添加<code>type: approval</code>。</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">workflows:</span></span><br><span class="line">  <span class="attr">version:</span> <span class="number">2</span></span><br><span class="line">  <span class="attr">build-test-and-approval-deploy:</span></span><br><span class="line">    <span class="attr">jobs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">build</span>  <span class="comment"># your custom job from your config, that builds your code</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">test1:</span> <span class="comment"># your custom job; runs test suite 1</span></span><br><span class="line">          <span class="attr">requires:</span> <span class="comment"># test1 will not run until the `build` job is completed.</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">build</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">test2:</span> <span class="comment"># another custom job; runs test suite 2,</span></span><br><span class="line">          <span class="attr">requires:</span> <span class="comment"># test2 is dependent on the succes of job `test1`</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">test1</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">hold:</span> <span class="comment"># &lt;&lt;&lt; A job that will require manual approval in the CircleCI web application.</span></span><br><span class="line">          <span class="attr">type:</span> <span class="string">approval</span> <span class="comment"># &lt;&lt;&lt; This key-value pair will set your workflow to a status of "On Hold"</span></span><br><span class="line">          <span class="attr">requires:</span> <span class="comment"># We only run the "hold" job when test2 has succeeded</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">test2</span></span><br><span class="line">      <span class="comment"># On approval of the `hold` job, any successive job that requires the `hold` job will run.</span></span><br><span class="line">      <span class="comment"># In this case, a user is manually triggering the deploy job.</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">deploy:</span></span><br><span class="line">          <span class="attr">requires:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">hold</span></span><br></pre></td></tr></table></figure>
<p>上例中举例，就是在最后需要手动批准hold才能进行部署任务。</p>
<p>下面也有一些我们在工作流中需要注意的地方： * <code>approval</code>是仅在<code>workflow</code>下job的一个特殊类型。 * <code>hold</code>任务必须确保不再其他任务中重名。 * 这代表着，你的个人定制任务，像<code>build</code>或者<code>test1</code>在上例中不能给<code>type: approval</code>键 * 任务的名字随意。 * 在手动任务之后的任务都需要添加<code>require:</code>来依赖这个手动任务。 * 任务按顺序执行，直到碰到了<code>type: approval</code>。</p>
<p>下面展示一下截图 <img src="https://images-1253206717.cos.ap-guangzhou.myqcloud.com/blog/circleci/approval_job.png" /></p>
<p><img src="https://images-1253206717.cos.ap-guangzhou.myqcloud.com/blog/circleci/approval_job_dialog.png" /></p>
<h2 id="安排工作流程">安排工作流程</h2>
<p>手动书写每个分支的任务和流程十分的低效和耗时，所以我们能够在确定不同分支的运行时间。</p>
<h3 id="在夜晚执行的任务">在夜晚执行的任务</h3>
<p>默认工作流的触发依赖于每次<code>git push</code>，为了按照计划执行工作流，我们可以添加<code>triggers</code>键来特殊化工作调度。</p>
<p>下面的例子中，我们将运行一个旨在夜晚12点后运行的工作流。使用POSIX <code>crontab</code>语法指定<code>cron</code>键。<a href="https://www.unix.com/man-page/POSIX/1posix/crontab/">crontab man page</a>来查看基本语法。</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">workflows:</span></span><br><span class="line">  <span class="attr">version:</span> <span class="number">2</span></span><br><span class="line">  <span class="attr">commit:</span></span><br><span class="line">    <span class="attr">jobs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">test</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">deploy</span></span><br><span class="line">  <span class="attr">nightly:</span></span><br><span class="line">    <span class="attr">triggers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">schedule:</span></span><br><span class="line">          <span class="attr">cron:</span> <span class="string">"0 0 * * *"</span></span><br><span class="line">          <span class="attr">filters:</span></span><br><span class="line">            <span class="attr">branches:</span></span><br><span class="line">              <span class="attr">only:</span></span><br><span class="line">                <span class="bullet">-</span> <span class="string">master</span></span><br><span class="line">                <span class="bullet">-</span> <span class="string">beta</span></span><br><span class="line">    <span class="attr">jobs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">coverage</span></span><br></pre></td></tr></table></figure>
<h3 id="制定有效的计划">制定有效的计划</h3>
<p>一个有效的计划，需要<code>cron</code>键和<code>filter</code>键。<code>cron</code>的键值必须是一个有效的<code>vaild crontab entry</code>键。</p>
<h3 id="使用任务上下文来分享环境变量">使用任务上下文来分享环境变量</h3>
<p>下面的例子展示了如何使用上下文来在一个工作流的四个平行任务中分享环境变量。</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">workflows:</span></span><br><span class="line">  <span class="attr">version:</span> <span class="number">2</span></span><br><span class="line">  <span class="attr">build-test-and-deploy:</span></span><br><span class="line">    <span class="attr">jobs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">build</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">test1:</span></span><br><span class="line">          <span class="attr">requires:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">build</span></span><br><span class="line">          <span class="attr">context:</span> <span class="string">org-global</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">test2:</span></span><br><span class="line">          <span class="attr">requires:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">test1</span></span><br><span class="line">          <span class="attr">context:</span> <span class="string">org-global</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">deploy:</span></span><br><span class="line">          <span class="attr">requires:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">test2</span></span><br></pre></td></tr></table></figure>
<h2 id="分支级别的任务执行">分支级别的任务执行</h2>
<p>下面的例子会展示，如何在三个分支配置任务流。工作流会在忽略在任务底下的分支键，如果想在工作流中添加任务级别的分支，需要移除任务级别的分支，转而描述它。</p>
<p><img src="https://images-1253206717.cos.ap-guangzhou.myqcloud.com/blog/circleci/branch_level.png" /></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">workflows:</span></span><br><span class="line">  <span class="attr">version:</span> <span class="number">2</span></span><br><span class="line">  <span class="attr">dev_stage_pre-prod:</span></span><br><span class="line">    <span class="attr">jobs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">test_dev:</span></span><br><span class="line">          <span class="attr">filters:</span>  <span class="comment"># using regex filters requires the entire branch to match</span></span><br><span class="line">            <span class="attr">branches:</span></span><br><span class="line">              <span class="attr">only:</span>  <span class="comment"># only branches matching the below regex filters will run</span></span><br><span class="line">                <span class="bullet">-</span> <span class="string">dev</span></span><br><span class="line">                <span class="bullet">-</span> <span class="string">/user-.*/</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">test_stage:</span></span><br><span class="line">          <span class="attr">filters:</span></span><br><span class="line">            <span class="attr">branches:</span></span><br><span class="line">              <span class="attr">only:</span> <span class="string">stage</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">test_pre-prod:</span></span><br><span class="line">          <span class="attr">filters:</span></span><br><span class="line">            <span class="attr">branches:</span></span><br><span class="line">              <span class="attr">only:</span> <span class="string">/pre-prod(?:-.+)?$/</span></span><br></pre></td></tr></table></figure>
<h2 id="执行git-tag的工作流">执行Git Tag的工作流</h2>
<p>circleci并不会主动执行 git tags 分支，除非你定义特定的tags过滤器。如果一个任务直接间接的需要另外一个任务，你必须指定正则表达式来制定任务的tag filter。轻量级和注释的tag都被支持。</p>
<p>下面的例子展示了两种tag分支方式： 1. <code>untagged-build</code>为所有分支运行<code>build</code>任务。 2. <code>tagged-build</code>为所有分支和带<code>v</code>的标签运行<code>build</code>。</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">workflows:</span></span><br><span class="line">  <span class="attr">version:</span> <span class="number">2</span></span><br><span class="line">  <span class="attr">untagged-build:</span></span><br><span class="line">    <span class="attr">jobs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">build</span></span><br><span class="line">  <span class="attr">tagged-build:</span></span><br><span class="line">    <span class="attr">jobs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">build:</span></span><br><span class="line">          <span class="attr">filters:</span></span><br><span class="line">            <span class="attr">tags:</span></span><br><span class="line">              <span class="attr">only:</span> <span class="string">/^v.*/</span></span><br></pre></td></tr></table></figure>
<p>下面展示的三个例子就是workflow的步骤 * build跑所有分支和有<code>config-test</code>名称的tags。 * test跑所有分支和有<code>config-test</code>名称的tags。 * deploy不跑分支只跑有<code>config-test</code>的任务。</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">workflows:</span></span><br><span class="line">  <span class="attr">version:</span> <span class="number">2</span></span><br><span class="line">  <span class="attr">build-test-deploy:</span></span><br><span class="line">    <span class="attr">jobs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">build:</span></span><br><span class="line">          <span class="attr">filters:</span>  <span class="comment"># required since `test` has tag filters AND requires `build`</span></span><br><span class="line">            <span class="attr">tags:</span></span><br><span class="line">              <span class="attr">only:</span> <span class="string">/^config-test.*/</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">test:</span></span><br><span class="line">          <span class="attr">requires:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">build</span></span><br><span class="line">          <span class="attr">filters:</span>  <span class="comment"># required since `deploy` has tag filters AND requires `test`</span></span><br><span class="line">            <span class="attr">tags:</span></span><br><span class="line">              <span class="attr">only:</span> <span class="string">/^config-test.*/</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">deploy:</span></span><br><span class="line">          <span class="attr">requires:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">test</span></span><br><span class="line">          <span class="attr">filters:</span></span><br><span class="line">            <span class="attr">tags:</span></span><br><span class="line">              <span class="attr">only:</span> <span class="string">/^config-test.*/</span></span><br><span class="line">            <span class="attr">branches:</span></span><br><span class="line">              <span class="attr">ignore:</span> <span class="string">/.*/</span></span><br></pre></td></tr></table></figure>
<p>需要注意的是，GitHub的分支单词只能承受5MB和少于三个标签。意味着，如果你一次添加多个标签，那么CircleCi也许不会接受他们全部。</p>
<h2 id="使用工作区来在任务中分享数据">使用工作区来在任务中分享数据</h2>
<p>每个工作流都有一个相关的工作区，能够将文件转换为下游任务的工作流流程。工作区仅用来添加数据的储存。任务可以在工作区中持久化数据。此配置归档数据并在容器外存储中创建新层。下游文件可以通过文件系统的容器访问工作区。附加工作区会根据工作流程中上游作业的顺序下载并解压缩每个层。</p>
<p><img src="https://images-1253206717.cos.ap-guangzhou.myqcloud.com/blog/circleci/Diagram-v3-Workspaces.png" /></p>
<p>使用工作区来传递当前层及下层需要的特殊数据。工作流程的任务运行于多个分支，也许需要将数据分享到工作区中。工作区也可以用于在测试容器中比较数据。</p>
<p>举个例子，Scala项目一般需要打来的CPU计算来完成build任务。相比之下，Scala测试任务不是CPU密集型的而且可以很好的跨容器并行化。使用一个大的容器来build任务，然后保存编译好的数据到工作区，能够让测试容器中使用到编译好的数据。</p>
<p>第二个例子就是，一个能编译的项目，使用build好的包，然后保存到工作区。build任务扇出到的分支能够并行的使用打包好的文件。</p>
<p>为了将一个任务中的数据持久化，并使它能够在其他的任务中使用。我们需要使用<code>persist_to_workspace</code>键。文件和目录中的带有<code>paths</code>的属性使用<code>persist_to_workspace</code>会被上传到工作区中的临时目录中，相对于<code>root</code>键定义的目录。文件和目录在这时上传之后，就可以在相应的子任务中使用。</p>
<p>配置任务接收存储的数据，需要用到<code>attach_workspace</code>键。下面的例子中的<code>config.yml</code>文件中，定义了下游文件使用了流任务中的两个任务。这里的工作流是顺序的。所以<code>downstream</code>需要等到流文件结束才能开始。</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Note that the following stanza uses CircleCI 2.1 to make use of a Reusable Executor</span></span><br><span class="line"><span class="comment"># This allows defining a docker image to reuse across jobs.</span></span><br><span class="line"><span class="comment"># visit https://circleci.com/docs/2.0/reusing-config/#authoring-reusable-executors to learn more.</span></span><br><span class="line"></span><br><span class="line"><span class="attr">version:</span> <span class="number">2.1</span></span><br><span class="line"></span><br><span class="line"><span class="attr">executors:</span></span><br><span class="line">  <span class="attr">my-executor:</span></span><br><span class="line">    <span class="attr">docker:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">buildpack-deps:jessie</span></span><br><span class="line">    <span class="attr">working_directory:</span> <span class="string">/tmp</span></span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">flow:</span></span><br><span class="line">    <span class="attr">executor:</span> <span class="string">my-executor</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">run:</span> <span class="string">mkdir</span> <span class="string">-p</span> <span class="string">workspace</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">run:</span> <span class="string">echo</span> <span class="string">"Hello, world!"</span> <span class="string">&gt;</span> <span class="string">workspace/echo-output</span></span><br><span class="line"></span><br><span class="line">      <span class="comment"># Persist the specified paths (workspace/echo-output) into the workspace for use in downstream job.</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">persist_to_workspace:</span></span><br><span class="line">          <span class="comment"># Must be an absolute path, or relative path from working_directory. This is a directory on the container which is</span></span><br><span class="line">          <span class="comment"># taken to be the root directory of the workspace.</span></span><br><span class="line">          <span class="attr">root:</span> <span class="string">workspace</span></span><br><span class="line">          <span class="comment"># Must be relative path from root</span></span><br><span class="line">          <span class="attr">paths:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">echo-output</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">downstream:</span></span><br><span class="line">    <span class="attr">executor:</span> <span class="string">my-executor</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">attach_workspace:</span></span><br><span class="line">          <span class="comment"># Must be absolute path or relative path from working_directory</span></span><br><span class="line">          <span class="attr">at:</span> <span class="string">/tmp/workspace</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line">          <span class="string">if</span> <span class="string">[[</span> <span class="string">`cat</span> <span class="string">/tmp/workspace/echo-output`</span> <span class="string">==</span> <span class="string">"Hello, world!"</span> <span class="string">]];</span> <span class="string">then</span></span><br><span class="line">            <span class="string">echo</span> <span class="string">"It worked!"</span><span class="string">;</span></span><br><span class="line">          <span class="string">else</span></span><br><span class="line">            <span class="string">echo</span> <span class="string">"Nope!"</span><span class="string">;</span> <span class="string">exit</span> <span class="number">1</span></span><br><span class="line">          <span class="string">fi</span></span><br><span class="line"></span><br><span class="line"><span class="attr">workflows:</span></span><br><span class="line">  <span class="attr">version:</span> <span class="number">2.1</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">btd:</span></span><br><span class="line">    <span class="attr">jobs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">flow</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">downstream:</span></span><br><span class="line">          <span class="attr">requires:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">flow</span></span><br></pre></td></tr></table></figure>
<p>可通过<a href="https://circleci.com/blog/persisting-data-in-workflows-when-to-use-caching-artifacts-and-workspaces/">Persisting Data in Workflows: When to Use Caching, Artifacts, and Workspaces</a>查看更多的关于使用workspaces, caching, and artifacts。</p>
<h2 id="重运行失败的任务">重运行失败的任务</h2>
<p>当你使用工作流的时候，你能增加你快速响应失败任务的能力。为了重运行工作流中失败的任务。你可以在<strong>Workflows</strong>中选择相应的工作流，选择<strong>Rerun</strong>按钮。</p>
<figure>
<img src="https://images-1253206717.cos.ap-guangzhou.myqcloud.com/blog/circleci/rerun-from-failed.png" alt="" /><figcaption>return</figcaption>
</figure>
<h2 id="故障排除">故障排除</h2>
<p>这个章节讨论一些工作流中常见的问题。</p>
<h3 id="工作流没有开始">工作流没有开始</h3>
<p>如果你创建和修改了工作流的配置，如果你没看见新的任务，很有可能是你的配置文件<code>config.yml</code>出现了问题。</p>
<p>通常情况下，如果你没看见你的工作流正常触发，配置错误阻止了工作流的启动。作为结论，工作流没有启动任何一个任务。</p>
<p>在设置工作流程时，您当前必须检查CircleCI应用程序的工作流程页面（而不是作业页面）以查看配置错误。</p>
<p><img src="https://images-1253206717.cos.ap-guangzhou.myqcloud.com/blog/circleci/workflow-config-error.png" /></p>
<h3 id="工作流等待github的状态">工作流等待GitHub的状态。</h3>
<p><img src="https://images-1253206717.cos.ap-guangzhou.myqcloud.com/blog/circleci/github_branches_status.png" /></p>
<h1 id="配置circleci"><a href="https://circleci.com/docs/2.0/configuration-reference/">配置circleci</a></h1>
<h1 id="circleci-镜像"><a href="https://circleci.com/docs/2.0/circleci-images/">CircleCI 镜像</a></h1>
<ul>
<li>https://hub.docker.com/r/circleci/</li>
<li>https://github.com/circleci/circleci-images</li>
<li>https://github.com/circleci-public/circleci-dockerfiles</li>
</ul>
<h2 id="最佳实践">最佳实践</h2>
<p>最好确定好版本号，不适用last版本。Debian系统需要在尾部添加上<code>-jessie</code>和<code>-stretch</code>。</p>
<h3 id="使用镜像的便签来标注语言和操作系统">使用镜像的便签来标注语言和操作系统</h3>
<p><code>circleci/golang:1.8.6-jessie</code></p>
<p><strong>注意:</strong> 如果没有固定标签，Docker将会使用<code>latest</code>标签。<code>latest</code>引用的是最有一个稳定版本的镜像。这样的镜像时十分不稳定的，所以最佳时间推荐使用稳定的镜像。</p>
<h3 id="使用docker镜像id将图像固定到固定版本">使用Docker镜像ID将图像固定到固定版本</h3>
<p>每一个Docker都有唯一的ID。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sha256:df1808e61a9c32d0ec110960fed213ab2339451ca88941e9be01a03adc98396e</span><br></pre></td></tr></table></figure>
<p>如何找到最近的镜像的ID 1. 在CircleCI应用程序中，转到最后使用该镜像的构建中。 2. 在<strong>Test Summary</strong>栏中，点击<strong>Spin up environment</strong>。 3. 在日志输出中，找到镜像的摘要。 4. 将图像ID添加到图像名称，如下所示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">circleci&#x2F;ruby@sha256:df1808e61a9c32d0ec110960fed213ab2339451ca88941e9be01a03adc98396e</span><br></pre></td></tr></table></figure>
<h2 id="镜像类型">镜像类型</h2>
<p>CircleCi为了便利，提供了两种镜像。语言镜像和服务器镜像。所有的镜像都需要添加<code>circleci</code>用户来作为系统用户。</p>
<h3 id="镜像语言">镜像语言</h3>
<ul>
<li>Android</li>
<li>Clojure</li>
<li>Elixir</li>
<li>Go (Golang)</li>
<li>JRuby</li>
<li>Node.js</li>
<li>OpenJDK (Java)</li>
<li>PHP</li>
<li>Python</li>
<li>Ruby</li>
<li>Rust</li>
</ul>
<h3 id="语言镜像变体">语言镜像变体</h3>
<p>Circleci维持了一些语言变量的变体镜像。要使用这些变种将以下后缀之一添加到图像标记的末尾。</p>
<ul>
<li><code>-node</code> 包括用于多语言应用程序的Node.js.</li>
<li><code>-browsers</code> 包括Chrome，Firefox，Java 8和Geckodriver.</li>
<li><code>-browsers-legacy</code> 包括Chrome，Firefox，Java 8和PhantomJS.</li>
<li><code>-node-browsers</code> 结合了<code>-node</code>和<code>-browsers</code>变体.</li>
<li><code>-node-browsers-legacy</code> 结合了<code>-node</code>和<code>-browsers-legacy</code>变体.</li>
</ul>
<h3 id="服务器镜像">服务器镜像</h3>
<p>服务镜像是数据库等服务的便利镜像。这些景象应该在语言镜像之后列出，使之成为二级镜像。</p>
<ul>
<li><code>buildpack-deps</code></li>
<li><code>DynamoDB</code></li>
<li><code>MariaDB</code></li>
<li><code>MongoDB</code></li>
<li><code>MySQL</code></li>
<li><code>PostgreSQL</code></li>
<li><code>Redis</code></li>
</ul>
<h3 id="服务镜像变体">服务镜像变体</h3>
<p>使用RAM加速需要添加<code>-ram</code>后缀。举例，<code>circleci/postgres:9.5-postgis</code> =&gt; <code>circleci/postgres:9.5-postgis-ram</code>。</p>
<h2 id="预安装工具">预安装工具</h2>
<p>除了安卓镜像，其他都包括下列预安装工具，通过<code>apt-get</code>安装。</p>
<ul>
<li><code>bzip2</code></li>
<li><code>ca-certificates</code></li>
<li><code>curl</code></li>
<li><code>git</code></li>
<li><code>gnupg</code></li>
<li><code>gzip</code></li>
<li><code>locales</code></li>
<li><code>mercurial</code></li>
<li><code>net-tools</code></li>
<li><code>netcat</code></li>
<li><code>openssh-client</code></li>
<li><code>parallel</code></li>
<li><code>sudo</code></li>
<li><code>tar</code></li>
<li><code>unzip</code></li>
<li><code>wget</code></li>
<li><code>xvfb</code></li>
<li><code>zip</code></li>
</ul>
</div><div class="article-tags size-small is-uppercase mb-4"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted mr-2" rel="tag" href="/tags/%E8%87%AA%E5%8A%A8%E5%8C%96/">自动化</a><a class="link-muted mr-2" rel="tag" href="/tags/CircleCI/">CircleCI</a><p class="text-right font1_1"><time datetime="2020-03-27T08:06:33.234Z"><strong><em> 本文最后修改于: 2020-03-27.</em></strong></time></p></div><ul class="post-copyright"><li><strong>本文标题：</strong><a href="https://hddhyq.github.io/2019/01/25/CircleCI简单概念/">CircleCI简单概念</a></li><li><strong>本文作者：</strong><a href="https://hddhyq.github.io">hddhyq</a></li><li><strong>本文链接：</strong><a href="https://hddhyq.github.io/2019/01/25/CircleCI简单概念/">https://hddhyq.github.io/2019/01/25/CircleCI简单概念/</a></li><li><strong>版权声明：</strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="external nofollow" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明出处！</li></ul><div><div class="recommend-post"><span class="is-size-6 has-text-grey has-mr-7"># 相关文章</span><br><span>  1.<a class="is-size-6" href="/2019/01/31/CircleCI%E5%AE%9E%E8%B7%B5gh-pages%E9%83%A8%E7%BD%B2/" target="_blank">CircleCI实践gh-pages部署</a><br></span></div></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><div class="social-share" data-wechat-qrcode-helper=""></div><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2019/01/31/CircleCI%E5%AE%9E%E8%B7%B5gh-pages%E9%83%A8%E7%BD%B2/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">CircleCI实践gh-pages部署</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2019/01/15/%E7%AE%80%E5%8D%95%E8%81%8A%E4%B8%8B%E5%93%8D%E5%BA%94%E5%BC%8F%E5%B8%83%E5%B1%80/"><span class="level-item">简单聊下响应式布局</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><div id="comment-container"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.6.0/dist/gitalk.css"><script> $.getScript('/js/gitalk.min.js', function () { 
            var gitalk = new Gitalk({
            id: 'a7947a82ad6a05c780350781cb0fdddb',
            repo: 'blog_comments',
            owner: 'hddhyq',
            clientID: 'a03371b663a2b8d82494',
            clientSecret: '4ef09e925b4d1c73a5e16d5f7a811bcc2e787c4c',
            admin: ["hddhyq"],
            createIssueManually: true,
            distractionFreeMode: false,
            perPage: 10,
            pagerDirection: 'last',
            
            
            enableHotKey: true,
            isLocked: false
        })
        gitalk.render('comment-container')});</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1 is-sticky"><div class="card widget toc-scroll" id="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="is-flex" id="toc-item-概念" href="#概念"><span>概念</span></a><ul class="menu-list"><li><a class="is-flex" id="toc-item-镜像image" href="#镜像image"><span>镜像（Image）</span></a></li><li><a class="is-flex" id="toc-item-任务jobs" href="#任务jobs"><span>任务（Jobs）</span></a><ul class="menu-list"><li><a class="is-flex" id="toc-item-缓存" href="#缓存"><span>缓存</span></a></li></ul></li><li><a class="is-flex" id="toc-item-工作流" href="#工作流"><span>工作流</span></a><ul class="menu-list"><li><a class="is-flex" id="toc-item-工作区域和文件" href="#工作区域和文件"><span>工作区域和文件</span></a></li></ul></li></ul></li><li><a class="is-flex" id="toc-item-工作流-1" href="#工作流-1"><span>工作流</span></a><ul class="menu-list"><li><a class="is-flex" id="toc-item-概述" href="#概述"><span>概述</span></a><ul class="menu-list"><li><a class="is-flex" id="toc-item-平行任务" href="#平行任务"><span>平行任务</span></a></li><li><a class="is-flex" id="toc-item-顺序任务" href="#顺序任务"><span>顺序任务</span></a></li><li><a class="is-flex" id="toc-item-扇出扇入工作流示例" href="#扇出扇入工作流示例"><span>扇出&amp;#x2F;扇入工作流示例</span></a></li><li><a class="is-flex" id="toc-item-通过手动批准来控制工作流" href="#通过手动批准来控制工作流"><span>通过手动批准来控制工作流</span></a></li></ul></li><li><a class="is-flex" id="toc-item-安排工作流程" href="#安排工作流程"><span>安排工作流程</span></a><ul class="menu-list"><li><a class="is-flex" id="toc-item-在夜晚执行的任务" href="#在夜晚执行的任务"><span>在夜晚执行的任务</span></a></li><li><a class="is-flex" id="toc-item-制定有效的计划" href="#制定有效的计划"><span>制定有效的计划</span></a></li><li><a class="is-flex" id="toc-item-使用任务上下文来分享环境变量" href="#使用任务上下文来分享环境变量"><span>使用任务上下文来分享环境变量</span></a></li></ul></li><li><a class="is-flex" id="toc-item-分支级别的任务执行" href="#分支级别的任务执行"><span>分支级别的任务执行</span></a></li><li><a class="is-flex" id="toc-item-执行git-tag的工作流" href="#执行git-tag的工作流"><span>执行Git Tag的工作流</span></a></li><li><a class="is-flex" id="toc-item-使用工作区来在任务中分享数据" href="#使用工作区来在任务中分享数据"><span>使用工作区来在任务中分享数据</span></a></li><li><a class="is-flex" id="toc-item-重运行失败的任务" href="#重运行失败的任务"><span>重运行失败的任务</span></a></li><li><a class="is-flex" id="toc-item-故障排除" href="#故障排除"><span>故障排除</span></a><ul class="menu-list"><li><a class="is-flex" id="toc-item-工作流没有开始" href="#工作流没有开始"><span>工作流没有开始</span></a></li><li><a class="is-flex" id="toc-item-工作流等待github的状态" href="#工作流等待github的状态"><span>工作流等待GitHub的状态。</span></a></li></ul></li></ul></li><li><a class="is-flex" id="toc-item-配置circleci" href="#配置circleci"><span>配置circleci</span></a></li><li><a class="is-flex" id="toc-item-circleci-镜像" href="#circleci-镜像"><span>CircleCI 镜像</span></a><ul class="menu-list"><li><a class="is-flex" id="toc-item-最佳实践" href="#最佳实践"><span>最佳实践</span></a><ul class="menu-list"><li><a class="is-flex" id="toc-item-使用镜像的便签来标注语言和操作系统" href="#使用镜像的便签来标注语言和操作系统"><span>使用镜像的便签来标注语言和操作系统</span></a></li><li><a class="is-flex" id="toc-item-使用docker镜像id将图像固定到固定版本" href="#使用docker镜像id将图像固定到固定版本"><span>使用Docker镜像ID将图像固定到固定版本</span></a></li></ul></li><li><a class="is-flex" id="toc-item-镜像类型" href="#镜像类型"><span>镜像类型</span></a><ul class="menu-list"><li><a class="is-flex" id="toc-item-镜像语言" href="#镜像语言"><span>镜像语言</span></a></li><li><a class="is-flex" id="toc-item-语言镜像变体" href="#语言镜像变体"><span>语言镜像变体</span></a></li><li><a class="is-flex" id="toc-item-服务器镜像" href="#服务器镜像"><span>服务器镜像</span></a></li><li><a class="is-flex" id="toc-item-服务镜像变体" href="#服务镜像变体"><span>服务镜像变体</span></a></li></ul></li><li><a class="is-flex" id="toc-item-预安装工具" href="#预安装工具"><span>预安装工具</span></a></li></ul></li></ul></div></div><script type="text/javascript" async>
        $(document).ready(function () { //参考自 https://github.com/ppoffice/hexo-theme-icarus/pull/616/files
            var observerTopMargin;
            var scrollObserver;
            var headerElems = $(".headerlink");
            var activeTocItem;
        
            function initIntersectionObserver(docHeight) {
                observerTopMargin = docHeight;
                scrollObserver = new IntersectionObserver(scrollCallBack,
                    {
                        root: null,  // viewpoint
                        rootMargin: docHeight + "px 0px -80% 0px"  // cover top 30% of viewport to the top of document
                    })
            }
        
            function scrollCallBack(entries, observer) {
                if ($(window).scrollTop() > observerTopMargin * 0.7) { 
                    // User somehow scroll to 70% of observerTopMargin (which is inited as 200% document height)
                    // Observer top margin need to extend to cover all the space to the top of the document
                    initIntersectionObserver(observerTopMargin * 2)
                    observer.disconnect();
                    return;
                }
                let toActive;
                if (entries[0].intersectionRatio == 1) {  // enter viewed area
                    let entry = entries.reduce((u, v) => (u.target.toc_id > v.target.toc_id ? u : v));  // get the lowest item
                    toActive = $("#toc-item-" + $(entry.target).attr("href").substr(1));
                } else {
                    let entry = entries.reduce((u, v) => (u.target.toc_id < v.target.toc_id ? u : v));  // get the highest item
                    let idx = Math.max(entry.target.toc_id - 1, 0);
                    toActive = $("#toc-item-" + $(headerElems[idx]).attr("href").substr(1));
                }
                if (activeTocItem) activeTocItem.removeClass("is-current");
                activeTocItem = toActive
                activeTocItem.addClass("is-current");
            }
        
            initIntersectionObserver($(document).height() * 2);
            headerElems.each(function (index, obj) {
                obj.toc_id = index;
                scrollObserver.observe(obj);
            })
        });</script></div><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="is-rounded" src="https://www.gravatar.com/avatar/6dd1668d5e30a1368a1c35d9511b237b?s=128" alt="hddhyq"></figure><p class="title is-size-4 is-block line-height-inherit">hddhyq</p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">48</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">27</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">56</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/hddhyq" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-white is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/hddhyq"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-white is-marginless" target="_blank" rel="noopener" title="Email" href="mailto:brokenbonesdd@gmail.com"><i class="fa fa-envelope"></i></a><a class="level-item button is-transparent is-white is-marginless" target="_blank" rel="noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">最新评论</h3><span class="body_hot_comment">加载中，最新评论有1分钟延迟...</span></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content size-small"><p><time dateTime="2020-05-18T15:30:39.000Z">2020-05-18</time></p><p class="title is-6"><a class="link-muted" href="/2020/05/18/intro-docker/">简介Docker容器</a></p><p class="is-uppercase"><i class="fas fa-folder-open has-text-grey"> </i><a class="link-muted" href="/categories/DevOps/">DevOps</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-04-26T15:05:31.000Z">2020-04-26</time></p><p class="title is-6"><a class="link-muted" href="/2020/04/26/browser-cache-control/">浏览器缓存详解</a></p><p class="is-uppercase"><i class="fas fa-folder-open has-text-grey"> </i><a class="link-muted" href="/categories/Browser/">Browser</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-03-24T09:30:16.000Z">2020-03-24</time></p><p class="title is-6"><a class="link-muted" href="/2020/03/24/%E6%9E%84%E5%BB%BA%E7%AE%80%E6%98%93%E7%BD%91%E9%A1%B5%E6%B5%8F%E8%A7%88%E5%99%A8/">构建简易网页浏览器</a></p><p class="is-uppercase"><i class="fas fa-folder-open has-text-grey"> </i><a class="link-muted" href="/categories/Browser/">Browser</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-02-06T11:48:22.000Z">2020-02-06</time></p><p class="title is-6"><a class="link-muted" href="/2020/02/06/%E6%8A%BD%E8%B1%A1%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%A4%9A%E9%87%8D%E8%A1%A8%E7%A4%BA/">抽象系统的多重表示</a></p><p class="is-uppercase"><i class="fas fa-folder-open has-text-grey"> </i><a class="link-muted" href="/categories/sicp/">sicp</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2019-11-18T15:29:10.000Z">2019-11-18</time></p><p class="title is-6"><a class="link-muted" href="/2019/11/18/%E4%BD%A0%E6%89%80%E9%9C%80%E8%A6%81%E4%BA%86%E8%A7%A3%E7%9A%84CSS%E5%8F%98%E9%87%8F%E7%9F%A5%E8%AF%86%E7%82%B9/">你所需要了解的CSS变量知识点</a></p><p class="is-uppercase"><i class="fas fa-folder-open has-text-grey"> </i><a class="link-muted" href="/categories/CSS/">CSS</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/Browser/"><span class="level-start"><span class="level-item">Browser</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/CSS/"><span class="level-start"><span class="level-item">CSS</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/CircleCI/"><span class="level-start"><span class="level-item">CircleCI</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/DevOps/"><span class="level-start"><span class="level-item">DevOps</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/HTML/"><span class="level-start"><span class="level-item">HTML</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/HTTP/"><span class="level-start"><span class="level-item">HTTP</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/JS/"><span class="level-start"><span class="level-item">JS</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/JStricks/"><span class="level-start"><span class="level-item">JStricks</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Puppeteer/"><span class="level-start"><span class="level-item">Puppeteer</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Webpack/"><span class="level-start"><span class="level-item">Webpack</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><a class="level is-mobile is-marginless" href="/categories/"><span class="level-start"><span class="level-item">查看全部&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2020/05/"><span class="level-start"><span class="level-item">五月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/04/"><span class="level-start"><span class="level-item">四月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/03/"><span class="level-start"><span class="level-item">三月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/02/"><span class="level-start"><span class="level-item">二月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/11/"><span class="level-start"><span class="level-item">十一月 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><a class="level is-mobile is-marginless" href="/archives/"><span class="level-start"><span class="level-item">查看全部&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/CSS/"><span class="tag">CSS</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JS/"><span class="tag">JS</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/node/"><span class="tag">node</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/css/"><span class="tag">css</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Webpack/"><span class="tag">Webpack</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/foundation/"><span class="tag">foundation</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"><span class="tag">设计模式</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84JS/"><span class="tag">你不知道的JS</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/html5/"><span class="tag">html5</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%AE%97%E6%B3%95/"><span class="tag">算法</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%87%AA%E5%8A%A8%E5%8C%96/"><span class="tag">自动化</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mongodb/"><span class="tag">mongodb</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CircleCI/"><span class="tag">CircleCI</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/express/"><span class="tag">express</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/git/"><span class="tag">git</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Puppeteer/"><span class="tag">Puppeteer</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DevOps/"><span class="tag">DevOps</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Web%E4%BC%98%E5%8C%96/"><span class="tag">Web优化</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Web%E6%80%A7%E8%83%BD/"><span class="tag">Web性能</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/async/"><span class="tag">async</span><span class="tag is-grey-lightest">1</span></a></div></div><div class="field is-grouped is-grouped-multiline"><a class="tags has-addons" href="/tags/"><span class="tag">查看全部&gt;&gt;</span></a></div></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="https://images-1253206717.cos.ap-guangzhou.myqcloud.com/blog/logo.png" alt="hddhyq&#039;s blog" height="28"></a><p class="size-small"><span>&copy; 2020 hddhyq</span>  Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a> <br>© 版权说明：[本网站所有内容均收集于互联网或自己创作,<br>    方便于网友与自己学习交流，如有侵权，请<a href="/message" target="_blank">留言</a>，立即处理]<br><div class="size-small"><span id="busuanzi_container_site_uv">❤️感谢<strong> <span id="busuanzi_value_site_uv">99+</span> </strong></span>小伙伴的<strong> <span id="busuanzi_value_site_pv">99+</span> </strong>次光临，查看💐</div></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'https://hddhyq.github.io',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back-to-top.js" defer></script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.12/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" defer></script><script>document.addEventListener("DOMContentLoaded", function() {
            document.querySelectorAll('[role="article"] > .content').forEach(function(element) {
                renderMathInElement(element);
            });
        });</script><!--!--><!--!--><script src="/js/main.js" defer></script><script src="/js/comment-issue-data.js" defer></script><link rel="stylesheet" href="/css/insight.css"><div class="searchbox ins-search"><div class="searchbox-container ins-search-container"><div class="searchbox-input-wrapper"><input class="searchbox-input ins-search-input" type="text" placeholder="想要查找什么..."><span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span></div><div class="searchbox-result-wrapper ins-section-wrapper"><div class="ins-section-container"></div></div></div></div><script>(function (window) {
            var INSIGHT_CONFIG = {
                TRANSLATION: {
                    POSTS: '文章',
                    PAGES: '页面',
                    CATEGORIES: '分类',
                    TAGS: '标签',
                    UNTITLED: '(无标题)',
                },
                CONTENT_URL: '/content.json',
            };
            window.INSIGHT_CONFIG = INSIGHT_CONFIG;
        })(window);</script><script src="/js/insight.js" defer></script></body></html>